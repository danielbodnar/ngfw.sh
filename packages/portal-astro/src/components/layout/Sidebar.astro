---
const currentPath = Astro.url.pathname;

const navigation = [
  {
    section: 'Overview',
    items: [
      { name: 'Dashboard', href: '/dashboard', icon: 'chart-line' },
      { name: 'Devices', href: '/devices', icon: 'router' },
    ],
  },
  {
    section: 'Network',
    items: [
      { name: 'Routing', href: '/network/routing', icon: 'route' },
      { name: 'NAT', href: '/network/nat', icon: 'network-wired' },
      { name: 'WAN', href: '/network/wan', icon: 'globe' },
      { name: 'LAN', href: '/network/lan', icon: 'ethernet' },
      { name: 'WiFi', href: '/network/wifi', icon: 'wifi' },
      { name: 'DHCP', href: '/network/dhcp', icon: 'server' },
    ],
  },
  {
    section: 'Security',
    items: [
      { name: 'IPS', href: '/security/ips', icon: 'shield' },
      { name: 'Firewall', href: '/security/firewall', icon: 'fire' },
      { name: 'Traffic', href: '/security/traffic', icon: 'chart-network' },
      { name: 'DNS Filter', href: '/security/dns-filter', icon: 'filter' },
    ],
  },
  {
    section: 'Services',
    items: [
      { name: 'VPN Server', href: '/services/vpn-server', icon: 'key' },
      { name: 'VPN Client', href: '/services/vpn-client', icon: 'plug' },
      { name: 'QoS', href: '/services/qos', icon: 'gauge' },
      { name: 'DDNS', href: '/services/ddns', icon: 'dns' },
    ],
  },
  {
    section: 'Monitoring',
    items: [
      { name: 'Reports', href: '/monitoring/reports', icon: 'file-chart' },
      { name: 'Logs', href: '/monitoring/logs', icon: 'list' },
    ],
  },
];

function isActive(href: string): boolean {
  return currentPath === href || currentPath.startsWith(href + '/');
}
---

<aside class="w-64 bg-[--color-surface] border-r border-[--color-border] flex flex-col">
  <!-- Logo -->
  <div class="p-6 border-b border-[--color-border]">
    <a href="/dashboard" class="flex items-center gap-2">
      <div class="w-8 h-8 bg-[--color-primary] rounded-lg flex items-center justify-center">
        <span class="text-white font-bold">N</span>
      </div>
      <span class="text-xl font-semibold text-[--color-text-primary]">NGFW.sh</span>
    </a>
  </div>

  <!-- Navigation -->
  <nav class="flex-1 overflow-y-auto p-4 scrollbar-thin">
    {navigation.map(({ section, items }) => (
      <div class="mb-6">
        <h3 class="text-xs font-semibold text-[--color-text-muted] uppercase tracking-wider mb-2 px-3">
          {section}
        </h3>
        <ul class="space-y-1">
          {items.map(({ name, href, icon }) => (
            <li>
              <a
                href={href}
                class:list={[
                  'flex items-center gap-3 px-3 py-2 rounded-lg transition-colors',
                  isActive(href)
                    ? 'bg-[--color-primary] text-white'
                    : 'text-[--color-text-secondary] hover:bg-[--color-surface-hover] hover:text-[--color-text-primary]'
                ]}
              >
                <span class="text-sm font-medium">{name}</span>
              </a>
            </li>
          ))}
        </ul>
      </div>
    ))}
  </nav>

  <!-- User Section -->
  <div class="p-4 border-t border-[--color-border]">
    <a
      href="/settings"
      class="flex items-center gap-3 px-3 py-2 rounded-lg text-[--color-text-secondary] hover:bg-[--color-surface-hover] hover:text-[--color-text-primary] transition-colors"
    >
      <div class="w-8 h-8 rounded-full bg-[--color-primary] flex items-center justify-center">
        <span class="text-sm font-medium text-white">U</span>
      </div>
      <div class="flex-1 min-w-0">
        <p class="text-sm font-medium truncate">User Settings</p>
      </div>
    </a>
  </div>
</aside>
